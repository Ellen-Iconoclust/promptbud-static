<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PromptZen ‚Äî Discover & Share Viral AI Prompts</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#f6efe9;
      --card:#ffffff;
      --muted:#7a7a8c;
      --accent:#FF7B65; /* coral */
      --accent-2:#ffd9c8;
      --hover-purple:#A46BF5; /* your purple */
      --glass: rgba(255,255,255,0.7);
      --radius:14px;
      --shadow: 0 10px 30px rgba(20,20,30,0.06);
      --max-w:1200px;
      --accent-darker: #ff6040;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(circle at 20% 20%, rgba(255,235,230,0.6), transparent 10%),
                  radial-gradient(circle at 80% 70%, rgba(240,235,255,0.4), transparent 12%),
                  var(--bg);
      color:#222;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding-bottom:80px;
    }

    /* top glass nav container (contained, not browser) */
    .topbar-wrap{
      position:sticky; top:0; z-index:999;
      backdrop-filter: blur(6px);
      background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,255,255,0.7));
      border-bottom:1px solid rgba(0,0,0,0.03);
      box-shadow: 0 6px 18px rgba(10,10,12,0.03);
    }
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      max-width:var(--max-w);
      margin:0 auto;
      padding:14px 20px;
    }
    .logo{
      display:flex;
      gap:12px;
      align-items:center;
      cursor: pointer;
    }
    .logo .mark{
      width:44px;height:44px;border-radius:10px;
      display:flex;align-items:center;justify-content:center;color:white;font-weight:700;
      box-shadow: var(--shadow); background: radial-gradient(circle at 30% 30%, #ffd6c6, #ff8b6b);
    }
    .logo .mark svg{width:22px;height:22px;fill:white}
    .logo h1{margin:0;font-family:"Space Grotesk",sans-serif;font-weight:700;font-size:20px;color:#ff6d57}
    .brand-sub{font-size:12px;color:var(--muted);margin-top:2px}

    /* Desktop Navigation */
    .desktop-nav{display:flex; gap:12px; align-items:center;}
    .desktop-nav a{color:#333;text-decoration:none;padding:10px 14px;border-radius:12px;font-weight:600}
    .desktop-nav a.active{background:var(--accent);color:white;box-shadow:0 6px 18px rgba(255,123,101,0.18)}
    .desktop-nav a:hover{background:var(--hover-purple); color:white; transition: background .18s}

    /* Mobile Navigation */
    .mobile-nav-toggle {
      display: none;
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--muted);
      padding: 8px;
      border-radius: 8px;
    }
    .mobile-nav {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg);
      z-index: 1000;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transform: translateX(-100%);
      transition: transform 0.3s ease;
    }
    .mobile-nav.active {
      transform: translateX(0);
    }
    .mobile-nav-close {
      position: absolute;
      top: 20px;
      right: 20px;
      background: none;
      border: none;
      font-size: 28px;
      cursor: pointer;
      color: var(--muted);
      padding: 8px;
      border-radius: 8px;
    }
    .mobile-nav-links {
      display: flex;
      flex-direction: column;
      gap: 16px;
      align-items: center;
    }
    .mobile-nav-links a {
      color: #333;
      text-decoration: none;
      padding: 14px 24px;
      border-radius: 12px;
      font-weight: 600;
      font-size: 18px;
      width: 200px;
      text-align: center;
    }
    .mobile-nav-links a.active {
      background: var(--accent);
      color: white;
      box-shadow: 0 6px 18px rgba(255,123,101,0.18);
    }
    .mobile-nav-links a:hover {
      background: var(--hover-purple);
      color: white;
    }

    .btn{
      border:0;padding:10px 14px;border-radius:12px;font-weight:700;cursor:pointer;background:transparent;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .btn-primary{
      background:var(--accent);
      color:white;
      box-shadow:0 8px 30px rgba(255,123,101,0.18);
      position: relative;
      overflow: hidden;
    }
    .btn-primary:hover {
      background: linear-gradient(135deg, var(--accent) 0%, var(--hover-purple) 100%);
      transform: translateY(-2px);
      box-shadow: 0 12px 35px rgba(255,123,101,0.25);
    }
    .btn-ghost{
      background:var(--accent-2);
      color:#4a4a58;
    }
    .btn-ghost:hover {
      background: var(--hover-purple);
      color: white;
      transform: translateY(-2px);
    }
    .btn-success {
      background: var(--success);
      color: white;
    }
    .btn-danger {
      background: var(--danger);
      color: white;
    }
    .btn-warning {
      background: var(--warning);
      color: white;
    }

    /* content */
    .hero{
      height: 85vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 60px 20px 40px;
      position: relative;
      overflow: hidden;
    }
    .hero-content {
      max-width: 900px;
      margin: 0 auto;
      opacity: 0;
      transform: translateY(30px);
      animation: fadeInUp 1s ease forwards;
    }
    .hero h2{
      margin:0;font-family:"Space Grotesk",sans-serif;font-weight:700;font-size:clamp(3rem, 9vw, 6rem);color:#111;
      line-height:1.02;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }
    .hero .subline{
      font-size:clamp(1rem, 3vw, 1.3rem);
      color:var(--muted);
      margin-top:18px;
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 1s ease 0.3s forwards;
      line-height: 1.4;
    }
    .hero .actions{
      margin-top:24px;
      display:flex;
      gap:12px;
      justify-content:center;
      flex-wrap: wrap;
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 1s ease 0.6s forwards;
    }
    .hero .stats{
      display:flex;
      gap:20px;
      justify-content:center;
      margin-top:28px;
      flex-wrap: wrap;
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 1s ease 0.9s forwards;
    }
    .stat{
      background:var(--card);
      padding:16px 22px;
      border-radius:12px;
      box-shadow:var(--shadow);
      min-width: 120px;
      flex: 1;
      max-width: 180px;
    }
    .stat h3{margin:0;color:var(--accent);font-size:20px}
    .stat p{margin:6px 0 0;color:var(--muted);font-size:14px}

    /* Admin Dashboard */
    .admin-dashboard {
      max-width: var(--max-w);
      margin: 40px auto;
      padding: 0 20px;
    }
    .admin-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .admin-stat {
      background: var(--card);
      padding: 24px;
      border-radius: 14px;
      box-shadow: var(--shadow);
      text-align: center;
    }
    .admin-stat h3 {
      margin: 0;
      font-size: 32px;
      color: var(--accent);
    }
    .admin-stat.pending h3 { color: var(--warning); }
    .admin-stat.approved h3 { color: var(--success); }
    .admin-stat.trending h3 { color: var(--hover-purple); }
    .admin-stat p {
      margin: 8px 0 0;
      color: var(--muted);
      font-weight: 600;
    }

    /* Trending section */
    .trending-section {
      max-width: var(--max-w);
      margin: 100px auto 24px;
      padding: 0 20px;
      text-align: center;
    }
    .trending-section h3 {
      font-family: 'Space Grotesk', sans-serif;
      font-size: clamp(1.6rem, 3.5vw, 2.2rem);
      margin-bottom: 6px;
      line-height:1;
    }
    .trending-section .subtag {
      color:var(--muted);
      margin-bottom:28px;
      display:block;
      font-size:clamp(0.95rem,2.5vw,1.1rem);
    }

    /* layout panels */
    .page{
      max-width:var(--max-w);
      margin:6px auto;
      padding:0 20px;
      display:none;
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 0.5s ease forwards;
    }
    .page.active{display:block}

    /* Modal pages */
    .modal-page {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg);
      z-index: 1000;
      overflow-y: auto;
      display: none;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.3s ease, transform 0.3s ease;
    }
    .modal-page.active {
      display: block;
      opacity: 1;
      transform: translateY(0);
    }
    .modal-page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: var(--max-w);
      margin: 0 auto;
      padding: 20px;
    }
    .modal-page-content {
      max-width: var(--max-w);
      margin: 0 auto;
      padding: 0 20px 40px;
    }
    .close-modal {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--muted);
      padding: 8px;
      border-radius: 8px;
    }
    .close-modal:hover {
      background: var(--hover-purple);
      color: white;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(3,1fr);
      gap:18px;
      align-items: start;
    }
    @media (max-width:1100px){ .grid{grid-template-columns:repeat(2,1fr)} }
    @media (max-width:720px){ .grid{grid-template-columns:1fr} }

    .card{
      background:var(--card);
      border-radius:14px;
      padding:16px;
      box-shadow:var(--shadow);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      transition: transform 0.35s cubic-bezier(.2,.9,.2,1), box-shadow 0.35s;
      position:relative;
      height: fit-content;
      min-height: 520px;
    }
    .card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 25px 60px rgba(20,20,30,0.15);
    }
    .card .img{
      width:100%;
      height:200px;
      border-radius:10px;
      overflow:hidden;
      position:relative;
      background:#eee;
      flex-shrink: 0;
    }
    .card .img img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      transition: transform 0.6s cubic-bezier(.2,.9,.2,1);
    }
    .card:hover .img img{
      transform: scale(1.08);
    }
    .card h4{
      margin:16px 0 6px;
      font-family:'Space Grotesk',sans-serif;
      color:#333;
      font-size: clamp(16px, 2.6vw, 18px);
      line-height: 1.3;
      transition: color .22s;
      text-align: center;
      font-weight: 700;
    }
    .card .tagline { 
      color:var(--muted); 
      font-size:14px; 
      margin-bottom:12px; 
      text-align: center;
    }
    .card .prompt-box{
      background:#fff6ef;
      padding:12px;
      border-radius:10px;
      border:1px solid #f2e0d6;
      color:#4b4b5b;
      font-size:14px;
      line-height:1.5;
      margin-top:8px; 
      white-space:pre-wrap; 
      word-wrap:break-word;
      flex-grow: 1;
      overflow-y: auto;
      max-height: 120px;
    }
    .card .model-info {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 12px;
      padding: 8px 12px;
      background: #f8f9fa;
      border-radius: 8px;
      font-size: 13px;
      color: var(--muted);
    }
    .card .model-info svg {
      width: 16px;
      height: 16px;
      flex-shrink: 0;
    }
    .card .card-bottom{
      display:flex;
      align-items:center;
      justify-content:center;
      margin-top:16px;
      gap:8px;
    }
    .copy-btn{
      background: var(--accent);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius:10px;
      cursor:pointer;
      font-weight:600;
      display:flex;
      align-items:center;
      gap:10px;
      transition: all 0.25s;
      width: 100%;
      justify-content: center;
      font-size: 15px;
      box-shadow: 0 4px 15px rgba(255,123,101,0.2);
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    .copy-btn:hover {
      background: var(--hover-purple);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(164,107,245,0.3);
    }
    .card:hover h4 { 
      color:var(--accent-darker); 
    }

    /* Admin specific styles */
    .admin-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      flex-wrap: wrap;
    }
    .admin-actions .btn {
      flex: 1;
      min-width: 120px;
      justify-content: center;
    }
    .checkbox-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px;
      border: 1px solid #eee;
      border-radius: 8px;
      margin-bottom: 8px;
      background: var(--card);
    }
    .bulk-actions {
      background: var(--card);
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 20px;
      box-shadow: var(--shadow);
      display: flex;
      gap: 12px;
      align-items: center;
      flex-wrap: wrap;
    }
    .selected-count {
      background: var(--accent);
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
    }

    /* Search Bar Styles */
    .search-container {
      max-width: var(--max-w);
      margin: 0 auto 30px;
      padding: 0 20px;
    }
    .search-bar {
      width: 100%;
      max-width: 500px;
      margin: 0 auto;
      position: relative;
    }
    .search-input {
      width: 100%;
      padding: 14px 20px;
      border: 2px solid var(--accent);
      border-radius: 50px;
      font-size: 16px;
      background: var(--card);
      transition: all 0.3s ease;
      outline: none;
      box-shadow: var(--shadow);
    }
    .search-input:focus {
      border-color: var(--hover-purple);
      box-shadow: 0 0 0 3px rgba(164, 107, 245, 0.1);
    }
    .search-input:hover {
      border-color: var(--hover-purple);
    }
    .search-input::placeholder {
      color: var(--muted);
    }

    /* About Page Styles */
    .about-content {
      max-width: 800px;
      margin: 0 auto;
      padding: 40px 20px;
      text-align: center;
    }
    .about-content h2 {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 2.5rem;
      margin-bottom: 10px;
      color: #333;
    }
    .version-badge {
      display: inline-block;
      background: var(--accent);
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 30px;
      box-shadow: 0 4px 15px rgba(255,123,101,0.2);
    }
    .about-content p {
      font-size: 1.1rem;
      line-height: 1.8;
      color: #555;
      margin-bottom: 20px;
      text-align: left;
    }
    .about-signature {
      margin-top: 40px;
      padding: 20px;
      background: var(--card);
      border-radius: 12px;
      box-shadow: var(--shadow);
    }
    .about-signature h3 {
      font-family: 'Space Grotesk', sans-serif;
      color: var(--accent);
      margin-bottom: 8px;
    }
    .about-signature p {
      color: var(--muted);
      text-align: center;
      margin: 0;
    }

    /* Login/Register Form Styles */
    .auth-input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e5e7eb;
      border-radius: 10px;
      font-size: 16px;
      background: var(--card);
      transition: all 0.3s ease;
      outline: none;
      margin-top: 8px;
      box-sizing: border-box;
    }
    .auth-input:focus {
      border-color: var(--hover-purple);
      box-shadow: 0 0 0 3px rgba(164, 107, 245, 0.1);
    }
    .auth-input:hover {
      border-color: var(--hover-purple);
    }
    .form-label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      color: #333;
    }

    /* tag badge inside card if needed */
    .badge{
      display:inline-block;
      padding:6px 10px;
      border-radius:999px;
      background:#fff3f1;
      color:var(--accent);
      font-weight:700;
      font-size:12px
    }
    .badge.pending {
      background: #fff8e6;
      color: var(--warning);
    }
    .badge.approved {
      background: #f0f9ff;
      color: var(--success);
    }

    /* form panel */
    .panel{
      background:var(--card);
      padding:18px;
      border-radius:14px;
      box-shadow:var(--shadow);
      margin-top:6px;
    }
    input[type="text"], textarea, input[type="file"], select{
      width:100%;
      padding:10px;
      border-radius:10px;
      border:1px solid #eee;
      background:transparent;
      font-size:14px;
      margin-top:8px;
    }
    textarea{
      min-height:140px;
      resize:vertical
    }

    .center{
      display:flex;
      justify-content:center
    }

    /* login modal */
    .modal-backdrop{
      position:fixed;
      left:0;
      top:0;
      width:100%;
      height:100%;
      background:rgba(10,10,12,0.4);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:2000;
    }
    .modal{
      background:var(--card);
      padding:24px;
      border-radius:14px;
      min-width:380px;
      box-shadow:var(--shadow); 
      max-width: 90vw;
    }
    .modal.show{
      display:flex
    }

    /* Footer Styles */
    footer {
      background: white;
      padding: 60px 20px 30px;
      margin-top: 80px;
      border-top: 1px solid rgba(0,0,0,0.05);
    }
    .footer-content {
      max-width: var(--max-w);
      margin: 0 auto;
      text-align: center;
      color: var(--muted);
      font-size: 14px;
    }
    .footer-content a {
      color: var(--accent);
      text-decoration: none;
    }
    .footer-content a:hover {
      color: var(--hover-purple);
    }
    .made-with-love {
      margin-top: 20px;
      font-size: 16px;
    }

    /* small helpers */
    .muted{color:var(--muted)}
    .small { font-size:13px; color:var(--muted); }

    /* toast */
    .toast {
      position: fixed;
      right: 18px;
      bottom: 18px;
      background: rgba(34,34,34,0.95);
      color: white;
      padding: 10px 14px;
      border-radius: 12px;
      display: flex;
      gap: 10px;
      align-items: center;
      box-shadow: 0 10px 30px rgba(10,10,15,0.25);
      z-index: 9999;
      opacity: 0;
      transform: translateY(8px);
      transition: opacity .18s, transform .24s;
      pointer-events: none;
    }
    .toast.show { 
      opacity: 1; 
      transform: translateY(0); 
      pointer-events: auto; 
    }

    /* File Upload Styles */
    .file-upload-area {
      border: 2px dashed #ddd;
      border-radius: 12px;
      padding: 30px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      background: #fafafa;
      margin-top: 8px;
    }
    .file-upload-area:hover {
      border-color: var(--accent);
      background: #fff9f7;
    }
    .file-upload-area.dragover {
      border-color: var(--accent);
      background: #fff0ec;
    }
    .file-upload-icon {
      font-size: 48px;
      color: var(--muted);
      margin-bottom: 12px;
    }
    .file-upload-text {
      color: var(--muted);
      margin-bottom: 8px;
    }
    .file-upload-hint {
      font-size: 12px;
      color: var(--muted);
    }
    .upload-preview {
      margin-top: 12px;
      text-align: center;
    }
    .upload-preview img {
      max-width: 100%;
      max-height: 200px;
      border-radius: 8px;
      box-shadow: var(--shadow);
    }
    .upload-progress {
      width: 100%;
      height: 6px;
      background: #f0f0f0;
      border-radius: 3px;
      margin-top: 8px;
      overflow: hidden;
    }
    .upload-progress-bar {
      height: 100%;
      background: var(--accent);
      transition: width 0.3s ease;
      width: 0%;
    }

    /* Easter Egg Styles */
    .easter-egg-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }
    .easter-egg-modal.active {
      opacity: 1;
      pointer-events: all;
    }
    .easter-egg-content {
      background: white;
      padding: 30px;
      border-radius: 20px;
      max-width: 500px;
      width: 90%;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      transform: scale(0.8);
      transition: transform 0.3s ease;
    }
    .easter-egg-modal.active .easter-egg-content {
      transform: scale(1);
    }
    .easter-egg-content h2 {
      color: var(--accent);
      font-family: 'Space Grotesk', sans-serif;
      margin-bottom: 15px;
    }
    .easter-egg-content p {
      color: var(--muted);
      line-height: 1.6;
      margin-bottom: 20px;
    }
    .easter-egg-close {
      background: var(--accent);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    .easter-egg-close:hover {
      background: var(--hover-purple);
      transform: translateY(-2px);
    }

    /* Particle Effects */
    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9998;
    }
    .particle {
      position: absolute;
      border-radius: 50%;
      pointer-events: none;
    }

    /* Star Placement Easter Egg */
    .star-placer {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9997;
    }
    .star-placer.active {
      pointer-events: all;
    }
    .star {
      position: absolute;
      font-size: 30px;
      cursor: move;
      user-select: none;
      transition: transform 0.3s ease;
      z-index: 9998;
    }
    .star:hover {
      transform: scale(1.2);
    }
    .star-placer-controls {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: white;
      padding: 15px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      display: flex;
      gap: 10px;
      z-index: 9999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }
    .star-placer-controls.active {
      opacity: 1;
      pointer-events: all;
    }
    .star-placer-controls button {
      padding: 8px 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    .star-placer-controls .clear-btn {
      background: var(--warning);
      color: white;
    }
    .star-placer-controls .clear-btn:hover {
      background: #d97706;
    }

    /* Tic Tac Toe Easter Egg */
    .tictactoe-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }
    .tictactoe-modal.active {
      opacity: 1;
      pointer-events: all;
    }
    .tictactoe-content {
      background: white;
      padding: 30px;
      border-radius: 20px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      transform: scale(0.8);
      transition: transform 0.3s ease;
    }
    .tictactoe-modal.active .tictactoe-content {
      transform: scale(1);
    }
    .tictactoe-content h2 {
      color: var(--accent);
      font-family: 'Space Grotesk', sans-serif;
      margin-bottom: 15px;
    }
    .tictactoe-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 5px;
      margin: 20px auto;
      width: 240px;
      height: 240px;
    }
    .tictactoe-cell {
      width: 80px;
      height: 80px;
      background: #f8f9fa;
      border: 2px solid var(--accent);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .tictactoe-cell:hover {
      background: #fff0ec;
    }
    .tictactoe-cell.x {
      color: var(--accent);
    }
    .tictactoe-cell.o {
      color: var(--hover-purple);
    }
    .tictactoe-status {
      margin: 15px 0;
      font-size: 18px;
      font-weight: 600;
      color: var(--muted);
    }
    .tictactoe-controls {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 20px;
    }
    .tictactoe-controls button {
      padding: 8px 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    .tictactoe-controls .new-game-btn {
      background: var(--success);
      color: white;
    }
    .tictactoe-controls .new-game-btn:hover {
      background: #059669;
    }
    .tictactoe-controls .close-btn {
      background: var(--danger);
      color: white;
    }
    .tictactoe-controls .close-btn:hover {
      background: #dc2626;
    }

    /* Book Icon Easter Egg */
    .book-icon {
      position: fixed;
      bottom: 20px;
      left: 20px;
      font-size: 40px;
      cursor: pointer;
      z-index: 9999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
    }
    .book-icon.active {
      opacity: 1;
      pointer-events: all;
    }
    .book-icon:hover {
      transform: scale(1.1);
      transition: transform 0.3s ease;
    }

    /* New Easter Egg Styles */
    .quota-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }
    .quota-modal.active {
      opacity: 1;
      pointer-events: all;
    }
    .quota-content {
      background: white;
      padding: 30px;
      border-radius: 20px;
      max-width: 600px;
      width: 90%;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      transform: scale(0.8);
      transition: transform 0.3s ease;
    }
    .quota-modal.active .quota-content {
      transform: scale(1);
    }
    .quota-content h2 {
      color: var(--accent);
      font-family: 'Space Grotesk', sans-serif;
      margin-bottom: 15px;
    }
    .quota-content p {
      color: var(--muted);
      line-height: 1.6;
      margin-bottom: 20px;
      text-align: left;
    }
    .quota-close {
      background: var(--accent);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
      margin-top: 10px;
    }
    .quota-close:hover {
      background: var(--hover-purple);
      transform: translateY(-2px);
    }
    .learn-more-link {
      color: var(--accent);
      text-decoration: none;
      font-weight: 600;
      margin-top: 15px;
      display: inline-block;
      cursor: pointer;
    }
    .learn-more-link:hover {
      color: var(--hover-purple);
      text-decoration: underline;
    }
    .extended-quota-content {
      max-height: 400px;
      overflow-y: auto;
      padding-right: 10px;
    }
    .extended-quota-content::-webkit-scrollbar {
      width: 6px;
    }
    .extended-quota-content::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
    }
    .extended-quota-content::-webkit-scrollbar-thumb {
      background: var(--accent);
      border-radius: 10px;
    }

    /* Rickroll Easter Egg */
    .rickroll-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }
    .rickroll-modal.active {
      opacity: 1;
      pointer-events: all;
    }
    .rickroll-content {
      background: white;
      padding: 30px;
      border-radius: 20px;
      max-width: 500px;
      width: 90%;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      transform: scale(0.8);
      transition: transform 0.3s ease;
    }
    .rickroll-modal.active .rickroll-content {
      transform: scale(1);
    }
    .rickroll-content h2 {
      color: var(--accent);
      font-family: 'Space Grotesk', sans-serif;
      margin-bottom: 15px;
    }
    .photo-frame {
      width: 300px;
      height: 300px;
      margin: 0 auto 20px;
      border: 15px solid #f6efe9;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      background: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      position: relative;
    }
    .photo-frame img {
      max-width: 100%;
      max-height: 100%;
      object-fit: cover;
    }
    .rickroll-text {
      font-style: italic;
      color: var(--muted);
      font-size: 18px;
      margin: 20px 0;
    }
    .rickroll-close {
      background: var(--accent);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    .rickroll-close:hover {
      background: var(--hover-purple);
      transform: translateY(-2px);
    }

    /* Question Mark Easter Egg */
    .question-mark {
      position: fixed;
      bottom: 100px;
      right: 30px;
      width: 60px;
      height: 60px;
      background: var(--accent);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      font-weight: bold;
      cursor: pointer;
      z-index: 9999;
      box-shadow: 0 8px 25px rgba(255,123,101,0.4);
      animation: pulse 2s infinite;
      transition: all 0.3s ease;
      opacity: 0;
      pointer-events: none;
    }
    .question-mark.active {
      opacity: 1;
      pointer-events: all;
    }
    .question-mark:hover {
      background: var(--hover-purple);
      transform: scale(1.1);
    }

    @keyframes pulse {
      0% {
        box-shadow: 0 0 0 0 rgba(255,123,101,0.7);
      }
      70% {
        box-shadow: 0 0 0 15px rgba(255,123,101,0);
      }
      100% {
        box-shadow: 0 0 0 0 rgba(255,123,101,0);
      }
    }

    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .fade-in {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.5s ease, transform 0.5s ease;
    }
    .fade-in.visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .desktop-nav {
        display: none;
      }
      .mobile-nav-toggle {
        display: block;
      }
      .hero .actions {
        flex-direction: column;
        align-items: center;
      }
      .hero .actions .btn {
        width: 100%;
        max-width: 280px;
        justify-content: center;
      }
      .hero .stats {
        gap: 12px;
      }
      .stat {
        min-width: 100px;
        padding: 14px 16px;
      }
      .stat h3 {
        font-size: 18px;
      }
      .modal-page-header h2 {
        font-size: 1.5rem;
      }
      .modal-page-content {
        padding: 0 15px 30px;
      }
      .card {
        min-height: 500px;
        padding: 14px;
      }
      .card .img {
        height: 180px;
      }
      .hero {
        height: 80vh;
        padding: 40px 20px 20px;
      }
      .admin-stats {
        grid-template-columns: repeat(2, 1fr);
      }
      .admin-actions {
        flex-direction: column;
      }
      .bulk-actions {
        flex-direction: column;
        align-items: stretch;
      }
      .file-upload-area {
        padding: 20px;
      }
      .checkbox-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
      }
      .checkbox-item .admin-actions {
        width: 100%;
        justify-content: space-between;
      }
      .checkbox-item .admin-actions .btn {
        flex: 1;
        min-width: auto;
      }
      .modal {
        min-width: 320px;
        padding: 20px;
      }
      .footer-content {
        padding: 0 20px;
      }
      .star-placer-controls {
        bottom: 10px;
        right: 10px;
        flex-direction: column;
      }
      .tictactoe-grid {
        width: 210px;
        height: 210px;
      }
      .tictactoe-cell {
        width: 70px;
        height: 70px;
      }
      .book-icon {
        bottom: 10px;
        left: 10px;
        font-size: 32px;
      }
      .question-mark {
        bottom: 80px;
        right: 20px;
        width: 50px;
        height: 50px;
        font-size: 20px;
      }
      .photo-frame {
        width: 250px;
        height: 250px;
      }
    }

    @media (max-width: 480px) {
      .logo h1 {
        font-size: 18px;
      }
      .logo .mark {
        width: 36px;
        height: 36px;
      }
      .hero h2 {
        font-size: clamp(1.6rem, 10vw, 2.6rem);
      }
      .hero .subline {
        font-size: 1rem;
      }
      .stat {
        min-width: 80px;
        padding: 12px 10px;
      }
      .stat h3 {
        font-size: 16px;
      }
      .stat p {
        font-size: 12px;
      }
      .card {
        min-height: 480px;
      }
      .card .img {
        height: 160px;
      }
      .copy-btn {
        padding: 10px 16px;
        font-size: 14px;
      }
      .trending-section .subtag {
        margin-bottom: 20px;
      }
      .admin-stats {
        grid-template-columns: 1fr;
      }
      .about-content h2 {
        font-size: 2rem;
      }
      .about-content p {
        font-size: 1rem;
      }
      .modal {
        min-width: 280px;
        padding: 16px;
      }
      .easter-egg-content {
        padding: 20px;
      }
      .tictactoe-content {
        padding: 20px;
      }
      .tictactoe-grid {
        width: 180px;
        height: 180px;
      }
      .tictactoe-cell {
        width: 60px;
        height: 60px;
        font-size: 24px;
      }
      .quota-content, .rickroll-content {
        padding: 20px;
      }
      .photo-frame {
        width: 200px;
        height: 200px;
      }
    }
  </style>
</head>
<body>

  <div class="topbar-wrap">
    <header>
      <div class="logo" id="logo">
        <div class="mark" aria-hidden="true">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M12 2.5l2.3 4.7 5.2.8-3.8 3.7.9 5.1L12 15.9l-4.6 2.4.9-5.1L4.5 8.0l5.2-.8L12 2.5z"/>
          </svg>
        </div>
        <div>
          <h1>PromptZen</h1>
          <div class="brand-sub">By Code Ronins</div>
        </div>
      </div>

      <!-- Desktop Navigation -->
      <nav class="desktop-nav">
        <a id="navHome" class="active" href="#" onclick="navTo('home')">Home</a>
        <a id="navGallery" href="#" onclick="openModalPage('gallery')">Gallery</a>
        <a id="navMy" href="#" onclick="openModalPage('my')">My Prompts</a>
        <a id="navAbout" href="#" onclick="openModalPage('about')">About</a>
        <a id="navAdmin" href="#" onclick="openModalPage('admin')" style="display:none">Admin</a>
        <a id="navLogin" href="#" onclick="openLogin()">Login</a>
      </nav>

      <!-- Mobile Navigation Toggle -->
      <button class="mobile-nav-toggle" onclick="toggleMobileNav()">‚ò∞</button>
    </header>
  </div>

  <!-- Mobile Navigation Menu -->
  <div class="mobile-nav" id="mobileNav">
    <button class="mobile-nav-close" onclick="toggleMobileNav()">√ó</button>
    <div class="mobile-nav-links">
      <a id="mobileNavHome" class="active" href="#" onclick="navToMobile('home')">Home</a>
      <a id="mobileNavGallery" href="#" onclick="openModalPageMobile('gallery')">Gallery</a>
      <a id="mobileNavMy" href="#" onclick="openModalPageMobile('my')">My Prompts</a>
      <a id="mobileNavAbout" href="#" onclick="openModalPageMobile('about')">About</a>
      <a id="mobileNavAdmin" href="#" onclick="openModalPageMobile('admin')" style="display:none">Admin</a>
      <a id="mobileNavLogin" href="#" onclick="openLoginMobile()">Login</a>
    </div>
  </div>

  <!-- HERO (home) -->
  <section class="hero">
    <div class="hero-content">
      <h2><span style="color:#000">Discover & Share</span><br><span style="display:block;margin-top:8px;color:var(--accent);">AI Prompts</span></h2>
      <div class="subline">Discover, submit, and manage creative AI prompts. Join a community of prompt engineers and creators pushing the boundaries of what's possible.</div>

      <div class="actions">
        <button class="btn-primary btn" onclick="openModalPage('my')">
          Submit Your Prompt
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <button class="btn btn-ghost" onclick="openModalPage('gallery')">Explore Gallery</button>
      </div>

      <div class="stats">
        <div class="stat">
          <h3 id="statPrompts">0</h3>
          <p>Prompts Shared</p>
        </div>
        <div class="stat">
          <h3 id="statUsers">0</h3>
          <p>Active Users</p>
        </div>
        <div class="stat">
          <h3 id="statCats">0</h3>
          <p>Categories</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Trending Section -->
  <section class="trending-section">
    <h3 id="trendingTitle">Trending Prompts</h3>
    <div id="trendingSub" class="subtag">Explore verified AI prompts with stunning visuals ‚Äî copy any prompt instantly</div>
    <div id="trendingGrid" class="grid"></div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="footer-content">
      <div>¬© 2025 PromptZen ‚Äî by <a href="https://coderonins.vercel.app" target="_blank">Code Ronins</a></div>
      <div class="made-with-love">Made with ‚ô•</div>
    </div>
  </footer>

  <!-- Modal Pages -->
  <div id="modalGallery" class="modal-page">
    <div class="modal-page-header">
      <h2 style="font-family:'Space Grotesk',sans-serif;margin:0;text-align:center;width:100%">Gallery</h2>
      <button class="close-modal" onclick="closeModalPage('gallery')">√ó</button>
    </div>
    <div class="modal-page-content">
      <div class="muted" style="margin-bottom:12px;text-align:center">All community prompts with sample images</div>
      
      <!-- Search Bar -->
      <div class="search-container">
        <div class="search-bar">
          <input type="text" id="searchInput" class="search-input" placeholder="Search prompts by title, tagline, or content..." />
        </div>
      </div>
      
      <div id="galleryGrid" class="grid"></div>
      <div id="noResults" style="display:none;text-align:center;padding:40px;color:var(--muted)">
        <h3>No results found</h3>
        <p>Try searching with different keywords</p>
      </div>
    </div>
  </div>

  <div id="modalMy" class="modal-page">
    <div class="modal-page-header">
      <h2 style="font-family:'Space Grotesk',sans-serif;margin:0">My Prompts</h2>
      <button class="close-modal" onclick="closeModalPage('my')">√ó</button>
    </div>
    <div class="modal-page-content">
      <div style="display:flex;gap:18px;flex-wrap:wrap">
        <div style="flex:1;min-width:320px">
          <div class="panel">
            <h4 style="font-family:'Space Grotesk',sans-serif;margin:0 0 6px">Submit Prompt</h4>
            <div class="muted">Enter prompt details and upload an image or provide a URL</div>

            <label>Username *</label>
            <input id="fusername" type="text" placeholder="Your name" />

            <label>Prompt Title *</label>
            <input id="ftitle" type="text" placeholder="Give your prompt a catchy title" />

            <label>Tagline *</label>
            <input id="ftagline" type="text" placeholder="Short description of your prompt" />

            <label>AI Model *</label>
            <select id="fmodel">
              <option value="">Select AI Model</option>
              <option value="ChatGPT">ChatGPT</option>
              <option value="Gemini">Gemini</option>
              <option value="Midjourney">Midjourney</option>
              <option value="DALL-E">DALL-E</option>
              <option value="Stable Diffusion">Stable Diffusion</option>
              <option value="Claude">Claude</option>
              <option value="Multiple">Multiple Models</option>
              <option value="Other">Other</option>
            </select>

            <label>Prompt Text *</label>
            <textarea id="ftext" placeholder="Describe the prompt (style, mood, lens, color grading, etc.)"></textarea>

            <label>Upload Image</label>
            <div class="file-upload-area" id="fileUploadArea">
              <div class="file-upload-icon">üìÅ</div>
              <div class="file-upload-text">Click to upload or drag and drop</div>
              <div class="file-upload-hint">PNG, JPG, GIF up to 5MB</div>
              <input type="file" id="fileInput" accept="image/*" style="display: none" />
            </div>
            <div class="upload-preview" id="uploadPreview"></div>
            <div class="upload-progress" id="uploadProgress" style="display: none">
              <div class="upload-progress-bar" id="uploadProgressBar"></div>
            </div>

            <div style="margin: 12px 0; text-align: center; color: var(--muted); font-size: 14px;">OR</div>

            <label>Image URL (alternative)</label>
            <input id="fimage" type="text" placeholder="https://example.com/image.jpg" />
            <div id="fpreview" style="margin-top:10px"></div>

            <div style="display:flex;gap:10px;margin-top:12px">
              <button id="submitBtn" class="btn-primary btn">
                Submit
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
              <button id="clearBtn" class="btn btn-ghost">Clear</button>
            </div>
          </div>
        </div>

        <div style="width:380px;min-width:260px">
          <div class="panel">
            <h4 style="margin:0;font-family:'Space Grotesk',sans-serif">My Submitted Prompts</h4>
            <div class="muted" style="margin-top:8px">Prompts you submitted will appear here after submission.</div>
            <div id="myPromptsList" style="margin-top:12px"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- About Page Modal -->
  <div id="modalAbout" class="modal-page">
    <div class="modal-page-header">
      <h2 style="font-family:'Space Grotesk',sans-serif;margin:0">About PromptZen</h2>
      <button class="close-modal" onclick="closeModalPage('about')">√ó</button>
    </div>
    <div class="modal-page-content">
      <div class="about-content">
        <h2>Welcome to PromptZen</h2>
        <div class="version-badge">Current Version: indev_008.00</div>
        <p>
          PromptZen is a revolutionary platform designed for AI enthusiasts, prompt engineers, and creative minds 
          to discover, share, and collaborate on the most effective AI prompts. In the rapidly evolving world of 
          artificial intelligence, the quality of prompts determines the quality of outputs. PromptZen serves as 
          a centralized hub where the community can contribute their most successful prompts across various AI 
          models including ChatGPT, Midjourney, DALL-E, Stable Diffusion, and more.
        </p>
        <p>
          Our mission is to democratize access to high-quality AI prompts and foster a community where both 
          beginners and experts can learn from each other. Whether you're looking to generate stunning visual 
          art, craft compelling stories, solve complex problems, or simply explore the capabilities of modern 
          AI systems, PromptZen provides the tools and community support to help you achieve your creative goals.
        </p>
        <p>
          The platform features a curated gallery of trending prompts, user submission system with admin 
          moderation, and an intuitive interface that makes prompt discovery and sharing seamless. Every 
          prompt on our platform is carefully reviewed to ensure quality and relevance, maintaining a 
          high standard for our growing community of AI practitioners.
        </p>
        <p>
          Join us in shaping the future of human-AI collaboration. Share your insights, learn from others, 
          and be part of the movement that's pushing the boundaries of what's possible with artificial intelligence.
        </p>
        
        <div class="about-signature">
          <h3>Ellen Iconoclust</h3>
          <p>Lead Developer @ Code Ronins</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Admin Dashboard Modal -->
  <div id="modalAdmin" class="modal-page">
    <div class="modal-page-header">
      <h2 style="font-family:'Space Grotesk',sans-serif;margin:0">Admin Dashboard</h2>
      <button class="close-modal" onclick="closeModalPage('admin')">√ó</button>
    </div>
    <div class="modal-page-content">
      <!-- Admin Stats -->
      <div class="admin-stats">
        <div class="admin-stat">
          <h3 id="adminTotalPrompts">0</h3>
          <p>Total Prompts</p>
        </div>
        <div class="admin-stat approved">
          <h3 id="adminApprovedPrompts">0</h3>
          <p>Approved</p>
        </div>
        <div class="admin-stat pending">
          <h3 id="adminPendingPrompts">0</h3>
          <p>Pending Review</p>
        </div>
        <div class="admin-stat trending">
          <h3 id="adminTrendingPrompts">0</h3>
          <p>Trending</p>
        </div>
        <div class="admin-stat">
          <h3 id="adminTotalUsers">0</h3>
          <p>Total Users</p>
        </div>
      </div>

      <!-- Pending Prompts Section -->
      <div class="panel">
        <h4 style="font-family:'Space Grotesk',sans-serif;margin:0 0 16px">Pending Prompts for Review</h4>
        
        <!-- Bulk Actions -->
        <div class="bulk-actions" style="display:none" id="bulkActions">
          <div class="selected-count" id="selectedCount">0 selected</div>
          <button class="btn btn-success" onclick="bulkApprovePrompts()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Approve Selected
          </button>
          <button class="btn btn-danger" onclick="bulkRejectPrompts()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Reject Selected
          </button>
          <button class="btn btn-ghost" onclick="clearSelection()">Clear Selection</button>
        </div>

        <div id="pendingPromptsList">
          <div class="muted">Loading pending prompts...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- login modal -->
  <div id="modal" class="modal-backdrop">
    <div class="modal">
      <div style="display: flex; gap: 10px; margin-bottom: 16px;">
        <button id="loginTab" class="btn btn-primary" style="flex: 1;" onclick="switchAuthTab('login')">Login</button>
        <button id="registerTab" class="btn btn-ghost" style="flex: 1;" onclick="switchAuthTab('register')">Register</button>
      </div>
      
      <div id="loginForm">
        <h3 style="margin:0">Login</h3>
        <div style="margin-top:8px">
          <label class="form-label">Username</label>
          <input id="loginUser" type="text" class="auth-input" placeholder="Enter your username"/>
          <label class="form-label" style="margin-top:16px">Password</label>
          <input id="loginPass" type="password" class="auth-input" placeholder="Enter your password"/>
          <div style="display:flex;gap:8px;margin-top:20px;justify-content:flex-end">
            <button onclick="closeLogin()" class="btn">Cancel</button>
            <button class="btn-primary btn" onclick="doLogin()">Login</button>
          </div>
        </div>
      </div>
      
      <div id="registerForm" style="display: none;">
        <h3 style="margin:0">Register</h3>
        <div style="margin-top:8px">
          <label class="form-label">Username</label>
          <input id="registerUser" type="text" class="auth-input" placeholder="Choose a username (3-20 characters)"/>
          <label class="form-label" style="margin-top:16px">Password</label>
          <input id="registerPass" type="password" class="auth-input" placeholder="At least 6 characters"/>
          <div style="font-size: 12px; color: var(--muted); margin-top: 8px;">
            Username must be 3-20 alphanumeric characters. Password must be at least 6 characters.
          </div>
          <div style="display:flex;gap:8px;margin-top:20px;justify-content:flex-end">
            <button onclick="closeLogin()" class="btn">Cancel</button>
            <button class="btn-primary btn" onclick="doRegister()">Register</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Easter Egg Modals -->
  <div id="logoEasterEgg" class="easter-egg-modal">
    <div class="easter-egg-content">
      <h2>Logo Secrets Revealed!</h2>
      <p>Hmm... Looks like you're too interested in the logo.</p>
      <p>Well, it's never just a Logo. Each corner represents one of the 5 members of Code Ronins who worked on this project.</p>
      <p>Now you can place stars anywhere on the page! Click anywhere to place a star, and drag it to move it around.</p>
      <button class="easter-egg-close" onclick="closeLogoEasterEgg()">Got it!</button>
    </div>
  </div>

  <!-- Tic Tac Toe Easter Egg -->
  <div id="tictactoeEasterEgg" class="tictactoe-modal">
    <div class="tictactoe-content">
      <h2>Tic Tac Toe</h2>
      <div class="tictactoe-status" id="tictactoeStatus">Player X's turn</div>
      <div class="tictactoe-grid" id="tictactoeGrid">
        <!-- Cells will be generated by JavaScript -->
      </div>
      <div class="tictactoe-controls">
        <button class="new-game-btn" onclick="startNewTicTacToeGame()">New Game</button>
        <button class="close-btn" onclick="closeTicTacToeEasterEgg()">Close</button>
      </div>
    </div>
  </div>

  <!-- New Quota Modal -->
  <div id="quotaModal" class="quota-modal">
    <div class="quota-content">
      <h2>Ouch! It Seems like You're Late to the Party</h2>
      <p>This month's Login/Register session has ended. But the collection never ends. Explore new and creative prompts without logging in or registering.</p>
      <p>If you have already registered or logged in, your account will be visible and usable next month. The date can be edited by the developer.</p>
      <button class="quota-close" onclick="closeQuotaModal()">OK Got It</button>
      <div class="learn-more-link" onclick="showExtendedQuotaInfo()">Learn More</div>
    </div>
  </div>

  <!-- Extended Quota Modal -->
  <div id="extendedQuotaModal" class="quota-modal">
    <div class="quota-content">
      <h2>PromptZen Service Model</h2>
      <div class="extended-quota-content">
        <p>PromptZen operates on a unique partial service model designed to maintain quality and prevent spam while ensuring the platform remains accessible to all users.</p>
        
        <h3>Monthly Quota System</h3>
        <p>Our platform allows users to register, login, and submit prompts during specific monthly windows. Each month, we open registration for a limited time before the quota runs out.</p>
        
        <h3>What Happens When Quota Ends?</h3>
        <p>Once the monthly quota is reached:</p>
        <ul>
          <li>New user registration is temporarily disabled</li>
          <li>Existing users can continue to access their accounts</li>
          <li>The website becomes static but remains fully interactive for browsing prompts</li>
          <li>All existing prompts remain accessible and can be copied</li>
        </ul>
        
        <h3>Benefits for Early Users</h3>
        <p>Users who register before the quota limit:</p>
        <ul>
          <li>Receive permanent account access</li>
          <li>Get priority consideration for prompt submissions</li>
          <li>May receive special credits or recognition</li>
          <li>Best contributors receive featured placement</li>
        </ul>
        
        <h3>Next Quota Availability</h3>
        <p>The next registration window will open on <strong>March 1, 2025</strong>. Mark your calendar!</p>
        
        <h3>Why This Model?</h3>
        <p>This approach helps us:</p>
        <ul>
          <li>Maintain high-quality content standards</li>
          <li>Prevent spam and low-effort submissions</li>
          <li>Ensure server stability and performance</li>
          <li>Create a curated community of prompt enthusiasts</li>
          <li>Reward early adopters and consistent contributors</li>
        </ul>
        
        <p>We believe this model creates the best experience for serious AI prompt enthusiasts while keeping the platform accessible to everyone for discovery and inspiration.</p>
      </div>
      <button class="quota-close" onclick="closeExtendedQuotaModal()">OK Got It</button>
    </div>
  </div>

  <!-- Rickroll Easter Egg Modal -->
  <div id="rickrollModal" class="rickroll-modal">
    <div class="rickroll-content">
      <h2>Special Discovery!</h2>
      <div class="photo-frame">
        <img src="rickroll.jpg" alt="Special Photo" onerror="this.style.display='none'; this.parentElement.innerHTML='<div style=\'color:var(--muted);font-size:18px;\'>Image not available</div>';">
      </div>
      <div class="rickroll-text">Never gonna give you up, never gonna let you down</div>
      <button class="rickroll-close" onclick="closeRickrollModal()">Close</button>
    </div>
  </div>

  <!-- Question Mark Easter Egg -->
  <div class="question-mark" id="questionMark" onclick="openRickrollModal()">?</div>

  <!-- Particle Effects Container -->
  <div id="particles" class="particles"></div>

  <!-- Star Placer Easter Egg -->
  <div id="starPlacer" class="star-placer">
    <div class="star-placer-controls" id="starPlacerControls">
      <button class="clear-btn" onclick="clearStars()">Clear Stars</button>
    </div>
  </div>

  <!-- Book Icon Easter Egg -->
  <div class="book-icon" id="bookIcon" onclick="openTicTacToeEasterEgg()">üìö</div>

  <!-- toast for copy -->
  <div id="toast" class="toast" aria-live="polite" role="status" style="display:flex;align-items:center;">
    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="flex:0 0 18px">
      <path d="M20 6L9 17l-5-5" stroke="#4ade80" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <div id="toastText">Copied to clipboard</div>
  </div>

  <script>
/* ------------------------------------------------------------------------- */
/* STATIC DATA - All prompts are defined here                               */
/* ------------------------------------------------------------------------- */

// Define all prompts directly in the code
const STATIC_PROMPTS = [
  {
    id: '1',
    username: 'AI_Artist_Pro',
    title: 'Cyberpunk Cityscape',
    tagline: 'Futuristic neon-lit urban environment',
    model: 'Midjourney',
    text: 'A sprawling cyberpunk cityscape at night, with towering skyscrapers, flying vehicles, and vibrant neon signs reflecting in rain-slicked streets. Dramatic lighting, cinematic composition, highly detailed, 8K resolution, futuristic aesthetic.',
    image_url: 'images/cyberpunk-cityscape.jpg',
    accepted: true,
    isTrending: true,
    created_at: '2025-01-15T10:30:00Z'
  },
  {
    id: '2',
    username: 'PromptMaster',
    title: 'Fantasy Dragon',
    tagline: 'Majestic mythical creature in epic landscape',
    model: 'DALL-E',
    text: 'A majestic dragon with iridescent scales, soaring over a mystical mountain range at sunset. Epic fantasy art style, detailed wings, glowing eyes, dramatic lighting, cinematic, highly detailed digital painting.',
    image_url: 'images/fantasy-dragon.jpg',
    accepted: true,
    isTrending: true,
    created_at: '2025-01-10T14:22:00Z'
  },
  {
    id: '3',
    username: 'CreativeCoder',
    title: 'Minimalist UI Design',
    tagline: 'Clean and modern user interface concept',
    model: 'Stable Diffusion',
    text: 'A minimalist user interface design for a productivity app, featuring clean lines, ample white space, subtle gradients, and intuitive iconography. Modern aesthetic, professional, clean typography, cohesive color palette.',
    image_url: 'images/minimalist-ui.jpg',
    accepted: true,
    isTrending: false,
    created_at: '2025-01-12T09:15:00Z'
  },
  {
    id: '4',
    username: 'NatureLover',
    title: 'Enchanted Forest',
    tagline: 'Magical woodland with bioluminescent flora',
    model: 'Midjourney',
    text: 'An enchanted forest at twilight, with bioluminescent mushrooms, glowing flowers, and ancient trees. Magical atmosphere, soft lighting, fantasy aesthetic, highly detailed, cinematic, dreamlike quality.',
    image_url: 'images/enchanted-forest.jpg',
    accepted: true,
    isTrending: true,
    created_at: '2025-01-08T16:45:00Z'
  },
  {
    id: '5',
    username: 'TechGuru',
    title: 'AI Brain Concept',
    tagline: 'Abstract representation of artificial intelligence',
    model: 'DALL-E',
    text: 'An abstract representation of an AI brain, with neural networks visualized as glowing connections, data streams flowing through circuits, and holographic interfaces. Futuristic, technological, vibrant colors, complex patterns.',
    image_url: 'images/ai-brain.jpg',
    accepted: true,
    isTrending: false,
    created_at: '2025-01-14T11:20:00Z'
  },
  {
    id: '6',
    username: 'PortraitArtist',
    title: 'Steampunk Character',
    tagline: 'Victorian-era inventor with mechanical enhancements',
    model: 'Stable Diffusion',
    text: 'A steampunk character portrait of a Victorian-era inventor with brass goggles, mechanical arm enhancements, intricate clockwork details, and vintage clothing. Detailed, atmospheric lighting, character design, fantasy aesthetic.',
    image_url: 'images/steampunk-character.jpg',
    accepted: true,
    isTrending: false,
    created_at: '2025-01-11T13:10:00Z'
  },
  {
    id: '7',
    username: 'ArchitectAI',
    title: 'Futuristic Eco-Home',
    tagline: 'Sustainable architecture integrated with nature',
    model: 'Midjourney',
    text: 'A futuristic eco-home seamlessly integrated into a natural landscape, featuring green roofs, solar panels, organic shapes, and large glass windows. Sustainable architecture, modern design, harmony with nature, innovative materials.',
    image_url: 'images/eco-home.jpg',
    accepted: true,
    isTrending: true,
    created_at: '2025-01-13T15:35:00Z'
  },
  {
    id: '8',
    username: 'SpaceExplorer',
    title: 'Alien Planet',
    tagline: 'Exotic extraterrestrial landscape with multiple moons',
    model: 'DALL-E',
    text: 'An alien planet landscape with bizarre flora, strange rock formations, multiple moons in the sky, and unusual atmospheric effects. Science fiction, otherworldly, vibrant colors, detailed environment, cinematic scale.',
    image_url: 'images/alien-planet.jpg',
    accepted: true,
    isTrending: false,
    created_at: '2025-01-09T18:50:00Z'
  },
  {
    id: '9',
    username: 'DigitalPainter',
    title: 'Abstract Cosmic Art',
    tagline: 'Vibrant nebula and celestial patterns',
    model: 'Stable Diffusion',
    text: 'Abstract cosmic art featuring vibrant nebula clouds, swirling galaxies, star clusters, and celestial patterns. Space art, vibrant colors, mystical, ethereal, digital painting, high contrast, mesmerizing patterns.',
    image_url: 'images/cosmic-art.jpg',
    accepted: true,
    isTrending: false,
    created_at: '2025-01-07T12:05:00Z'
  }
];

// Define admin user for testing
const ADMIN_USER = {
  username: 'admin',
  password: 'admin123',
  role: 'admin'
};

// Define regular users for testing
const STATIC_USERS = [
  ADMIN_USER,
  {
    username: 'demo',
    password: 'demo123',
    role: 'user'
  },
  {
    username: 'test',
    password: 'test123',
    role: 'user'
  }
];

// Define user-submitted prompts (stored in localStorage)
let userPrompts = JSON.parse(localStorage.getItem('userPrompts') || '[]');

let currentUser = { username:null, role:'user' };
let authToken = localStorage.getItem('promptzen_token');
let selectedPrompts = new Set();
let uploadedImageUrl = null;
let allGalleryPrompts = []; // Store all prompts for search functionality

// Easter Egg Variables
let logoClickCount = 0;
let logoClickTimer = null;
let starPlacerActive = false;
let tictactoeGameState = {
  board: ['', '', '', '', '', '', '', '', ''],
  currentPlayer: 'X',
  gameOver: false
};

// New Easter Egg Variables
let questionMarkShown = false;
let questionMarkClickCount = 0;

/* ------------------------------------------------------------------------- */
/* UX / Nav / Modal / Auth                                                  */
/* ------------------------------------------------------------------------- */
function toggleMobileNav() {
  const mobileNav = document.getElementById('mobileNav');
  mobileNav.classList.toggle('active');
  document.body.style.overflow = mobileNav.classList.contains('active') ? 'hidden' : 'auto';
}
function navToMobile(page) {
  navTo(page);
  toggleMobileNav();
}
function openModalPageMobile(page) {
  openModalPage(page);
  toggleMobileNav();
}
function openLoginMobile() {
  openLogin();
  toggleMobileNav();
}

function navTo(page){
  const pages = ['home','gallery','my','about','admin'];
  pages.forEach(p=>{
    const pageEl = document.getElementById('page'+capitalize(p));
    if(pageEl) pageEl.classList.remove('active');
    const nav = document.getElementById('nav'+capitalize(p));
    if(nav) nav.classList.remove('active');
    const mnav = document.getElementById('mobileNav'+capitalize(p));
    if(mnav) mnav.classList.remove('active');
  });
  
  const navId = (page === 'home') ? 'navHome' : (page === 'gallery' ? 'navGallery' : (page === 'admin' ? 'navAdmin' : (page === 'about' ? 'navAbout' : 'navMy')));
  const navItem = document.getElementById(navId);
  if(navItem) navItem.classList.add('active');
  const mobileItem = document.getElementById('mobileNav'+capitalize(page));
  if(mobileItem) mobileItem.classList.add('active');

  if(page === 'gallery') loadGallery();
  if(page === 'home') loadTrending();
  if(page === 'my') loadMyPrompts();
  if(page === 'admin') loadAdminDashboard();

  window.scrollTo({top: 0, behavior: 'smooth'});
}

function openModalPage(page) {
  const el = document.getElementById('modal' + capitalize(page));
  if(!el) return;
  el.classList.add('active');
  document.body.style.overflow = 'hidden';
  if(page === 'gallery') loadGallery();
  else if(page === 'my') {
    loadMyPrompts();
    // Show question mark with 1 in 20 chance
    if (!questionMarkShown && Math.random() < 0.05) { // 5% chance (1 in 20)
      showQuestionMark();
    }
  }
  else if(page === 'admin') loadAdminDashboard();
  else if(page === 'about') {
    // About page doesn't need additional loading
  }
}
function closeModalPage(page) {
  const el = document.getElementById('modal' + capitalize(page));
  if(!el) return;
  el.classList.remove('active');
  document.body.style.overflow = 'auto';
  selectedPrompts.clear();
  updateBulkActions();
}

function capitalize(s){ return s.charAt(0).toUpperCase() + s.slice(1); }

function switchAuthTab(tab) {
  const loginTab = document.getElementById('loginTab');
  const registerTab = document.getElementById('registerTab');
  const loginForm = document.getElementById('loginForm');
  const registerForm = document.getElementById('registerForm');
  
  if (tab === 'login') {
    loginTab.className = 'btn btn-primary';
    registerTab.className = 'btn btn-ghost';
    loginForm.style.display = 'block';
    registerForm.style.display = 'none';
  } else {
    loginTab.className = 'btn btn-ghost';
    registerTab.className = 'btn btn-primary';
    loginForm.style.display = 'none';
    registerForm.style.display = 'block';
  }
}

function openLogin(){ 
  // Show quota modal instead of login form
  openQuotaModal();
  // Uncomment the line below to use the original login functionality
  // document.getElementById('modal').style.display='flex'; 
  // switchAuthTab('login');
}
function closeLogin(){ document.getElementById('modal').style.display='none'; }

function doRegister(){
  const u = document.getElementById('registerUser').value.trim();
  const p = document.getElementById('registerPass').value;
  
  if(!u || !p) return alert('Please enter username and password');
  
  // Basic validation
  if (!u.match(/^[a-zA-Z0-9]{3,20}$/)) {
    return alert('Username must be 3-20 alphanumeric characters');
  }
  if (p.length < 6) {
    return alert('Password must be at least 6 characters');
  }

  // Check if username already exists
  const existingUser = STATIC_USERS.find(user => user.username === u);
  if (existingUser) {
    return alert('Username already exists');
  }

  // Add new user
  STATIC_USERS.push({
    username: u,
    password: p,
    role: 'user'
  });

  // Auto-login after registration
  currentUser = { username: u, role: 'user' };
  authToken = 'static_token_' + Date.now();
  localStorage.setItem('promptzen_token', authToken);
  localStorage.setItem('promptzen_user', JSON.stringify(currentUser));
  
  showToast('Registration successful! You are now logged in.');
  closeLogin();
  updateAuthUI();
  updateSubmitForm();
  loadTrending();
  loadGallery();
  loadMyPrompts();
}

function doLogin(){
  const u = document.getElementById('loginUser').value.trim();
  const p = document.getElementById('loginPass').value;
  if(!u || !p) return alert('Please enter username and password');

  // Find user in static users
  const user = STATIC_USERS.find(user => user.username === u && user.password === p);
  
  if (user) {
    currentUser = { username: user.username, role: user.role };
    authToken = 'static_token_' + Date.now();
    localStorage.setItem('promptzen_token', authToken);
    localStorage.setItem('promptzen_user', JSON.stringify(currentUser));
    showToast('Login successful!');
    closeLogin();
    updateAuthUI();
    updateSubmitForm();
    loadTrending();
    loadGallery();
    loadMyPrompts();
  } else {
    alert('Invalid username or password');
  }
}

function updateAuthUI(){
  const navLogin = document.getElementById('navLogin');
  const mobileNavLogin = document.getElementById('mobileNavLogin');
  const navAdmin = document.getElementById('navAdmin');
  const mobileNavAdmin = document.getElementById('mobileNavAdmin');

  if(currentUser && currentUser.role === 'admin'){
    navLogin.textContent = 'Logout (admin)';
    navLogin.onclick = ()=> { if(confirm('Logout?')) { logout(); } };
    mobileNavLogin.textContent = 'Logout (admin)';
    mobileNavLogin.onclick = ()=> { if(confirm('Logout?')) { logout(); } };
    navAdmin.style.display = 'flex';
    mobileNavAdmin.style.display = 'flex';
  } else if(currentUser && currentUser.username){
    navLogin.textContent = 'Logout ('+currentUser.username+')';
    navLogin.onclick = ()=> { if(confirm('Logout?')) { logout(); } };
    mobileNavLogin.textContent = 'Logout ('+currentUser.username+')';
    mobileNavLogin.onclick = ()=> { if(confirm('Logout?')) { logout(); } };
    navAdmin.style.display = 'none';
    mobileNavAdmin.style.display = 'none';
  } else {
    navLogin.textContent = 'Login';
    navLogin.onclick = ()=> openLogin();
    mobileNavLogin.textContent = 'Login';
    mobileNavLogin.onclick = ()=> openLoginMobile();
    navAdmin.style.display = 'none';
    mobileNavAdmin.style.display = 'none';
  }
}

function logout(){
  localStorage.removeItem('promptzen_user');
  localStorage.removeItem('promptzen_token');
  authToken = null;
  currentUser = { username:null, role:'user' };
  updateAuthUI();
  updateSubmitForm();
  showToast('Logged out successfully');
  loadTrending();
  loadGallery();
  loadMyPrompts();
}

/* ---------- File Upload Functions ---------- */
function initializeFileUpload() {
  const fileInput = document.getElementById('fileInput');
  const fileUploadArea = document.getElementById('fileUploadArea');
  const uploadPreview = document.getElementById('uploadPreview');
  const uploadProgress = document.getElementById('uploadProgress');
  const uploadProgressBar = document.getElementById('uploadProgressBar');
  const urlInput = document.getElementById('fimage');

  // Click handler
  fileUploadArea.addEventListener('click', () => {
    fileInput.click();
  });

  // Drag and drop handlers
  fileUploadArea.addEventListener('dragover', (e) => {
    e.preventDefault();
    fileUploadArea.classList.add('dragover');
  });

  fileUploadArea.addEventListener('dragleave', () => {
    fileUploadArea.classList.remove('dragover');
  });

  fileUploadArea.addEventListener('drop', (e) => {
    e.preventDefault();
    fileUploadArea.classList.remove('dragover');
    
    const files = e.dataTransfer.files;
    if (files.length > 0) {
      handleFileSelect(files[0]);
    }
  });

  // File input change handler
  fileInput.addEventListener('change', (e) => {
    if (e.target.files.length > 0) {
      handleFileSelect(e.target.files[0]);
    }
  });

  // URL input change handler - clear file upload if URL is entered
  urlInput.addEventListener('input', () => {
    if (urlInput.value.trim()) {
      resetFileUpload();
    }
  });

  async function handleFileSelect(file) {
    // Validate file type
    if (!file.type.startsWith('image/')) {
      alert('Please select an image file (PNG, JPG, JPEG, GIF, etc.)');
      return;
    }

    // Validate file size (5MB)
    if (file.size > 5 * 1024 * 1024) {
      alert('File size must be less than 5MB');
      return;
    }

    // Clear URL input when file is selected
    urlInput.value = '';
    document.getElementById('fpreview').innerHTML = '';

    // Show preview
    const reader = new FileReader();
    reader.onload = (e) => {
      uploadPreview.innerHTML = `<img src="${e.target.result}" alt="Preview" style="max-width: 100%; border-radius: 8px;">`;
      uploadedImageUrl = e.target.result;
    };
    reader.readAsDataURL(file);

    uploadProgress.style.display = 'block';
    uploadProgressBar.style.width = '100%';
    
    setTimeout(() => {
      uploadProgress.style.display = 'none';
      showToast('Image ready for upload!');
    }, 1000);
  }

  function resetFileUpload() {
    fileInput.value = '';
    uploadPreview.innerHTML = '';
    uploadProgress.style.display = 'none';
    uploadedImageUrl = null;
  }

  return { resetFileUpload };
}

// Initialize file upload when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
  initializeFileUpload();
});

/* ---------- Search Functionality ---------- */
function initializeSearch() {
  const searchInput = document.getElementById('searchInput');
  
  searchInput.addEventListener('input', (e) => {
    const searchTerm = e.target.value.toLowerCase().trim();
    filterGalleryPrompts(searchTerm);
  });

  // Add special search for book icon Easter egg
  searchInput.addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && this.value === '\\c0d3:bud') {
      activateBookIcon();
      this.value = '';
    }
  });
}

function filterGalleryPrompts(searchTerm) {
  const grid = document.getElementById('galleryGrid');
  const noResults = document.getElementById('noResults');
  
  if (!searchTerm) {
    // Show all prompts when search is empty
    grid.innerHTML = '';
    allGalleryPrompts.forEach(p => {
      const card = makeCardElement(p);
      card.classList.add('visible'); // Make sure cards are visible
      grid.appendChild(card);
    });
    noResults.style.display = 'none';
    return;
  }

  const filteredPrompts = allGalleryPrompts.filter(prompt => {
    const searchableText = `
      ${prompt.title || ''} 
      ${prompt.tagline || ''} 
      ${prompt.text || ''}
      ${prompt.model || ''}
      ${prompt.username || ''}
    `.toLowerCase();
    
    return searchableText.includes(searchTerm);
  });

  grid.innerHTML = '';
  
  if (filteredPrompts.length === 0) {
    noResults.style.display = 'block';
  } else {
    noResults.style.display = 'none';
    filteredPrompts.forEach(p => {
      const card = makeCardElement(p);
      card.classList.add('visible'); // Make sure cards are visible immediately
      grid.appendChild(card);
    });
  }
}

/* ---------- Load stored user ---------- */
(function(){
  const user = JSON.parse(localStorage.getItem('promptzen_user') || 'null');
  const token = localStorage.getItem('promptzen_token');
  if(user && token){
    currentUser = user;
    authToken = token;
  }
  updateAuthUI();
  initializeSearch(); // Initialize search functionality
  initializeEasterEggs(); // Initialize Easter eggs
})();

/* ---------- Easter Egg Functions ---------- */
function initializeEasterEggs() {
  // Logo click Easter egg
  const logo = document.getElementById('logo');
  logo.addEventListener('click', handleLogoClick);
  
  // Initialize Tic Tac Toe game
  initializeTicTacToe();
}

function handleLogoClick() {
  logoClickCount++;
  
  // Reset timer if it exists
  if (logoClickTimer) {
    clearTimeout(logoClickTimer);
  }
  
  // Set timer to reset click count after 2 seconds
  logoClickTimer = setTimeout(() => {
    logoClickCount = 0;
  }, 2000);
  
  // If clicked 6 times, activate the Easter egg
  if (logoClickCount >= 6) {
    activateLogoEasterEgg();
    logoClickCount = 0;
  }
}

function activateLogoEasterEgg() {
  const modal = document.getElementById('logoEasterEgg');
  modal.classList.add('active');
  
  // Activate star placer after modal is closed
  setTimeout(() => {
    activateStarPlacer();
  }, 3000);
}

function closeLogoEasterEgg() {
  const modal = document.getElementById('logoEasterEgg');
  modal.classList.remove('active');
}

function activateStarPlacer() {
  starPlacerActive = true;
  const starPlacer = document.getElementById('starPlacer');
  starPlacer.classList.add('active');
  
  // Show clear stars button
  const starPlacerControls = document.getElementById('starPlacerControls');
  starPlacerControls.classList.add('active');
  
  // Add click event to place stars
  starPlacer.addEventListener('click', placeStar);
}

function placeStar(e) {
  if (!starPlacerActive) return;
  
  const star = document.createElement('div');
  star.className = 'star';
  star.textContent = '‚≠ê';
  star.style.left = `${e.clientX - 15}px`;
  star.style.top = `${e.clientY - 15}px`;
  
  // Make star draggable
  makeElementDraggable(star);
  
  document.getElementById('starPlacer').appendChild(star);
  
  // Hide the logo Easter egg modal if it's still visible
  closeLogoEasterEgg();
}

function clearStars() {
  const stars = document.querySelectorAll('.star');
  stars.forEach(star => star.remove());
  
  // Deactivate star placer completely
  deactivateStarPlacer();
}

function deactivateStarPlacer() {
  starPlacerActive = false;
  const starPlacer = document.getElementById('starPlacer');
  starPlacer.classList.remove('active');
  
  // Hide clear stars button
  const starPlacerControls = document.getElementById('starPlacerControls');
  starPlacerControls.classList.remove('active');
  
  // Remove the click event listener
  starPlacer.removeEventListener('click', placeStar);
  
  showToast('Star placer deactivated!');
}

function makeElementDraggable(element) {
  let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
  
  element.onmousedown = dragMouseDown;
  
  function dragMouseDown(e) {
    e.preventDefault();
    // Get the mouse cursor position at startup
    pos3 = e.clientX;
    pos4 = e.clientY;
    document.onmouseup = closeDragElement;
    // Call a function whenever the cursor moves
    document.onmousemove = elementDrag;
  }
  
  function elementDrag(e) {
    e.preventDefault();
    // Calculate the new cursor position
    pos1 = pos3 - e.clientX;
    pos2 = pos4 - e.clientY;
    pos3 = e.clientX;
    pos4 = e.clientY;
    // Set the element's new position
    element.style.top = (element.offsetTop - pos2) + "px";
    element.style.left = (element.offsetLeft - pos1) + "px";
  }
  
  function closeDragElement() {
    // Stop moving when mouse button is released
    document.onmouseup = null;
    document.onmousemove = null;
  }
}

/* ---------- Book Icon and Tic Tac Toe Easter Egg ---------- */
function activateBookIcon() {
  const bookIcon = document.getElementById('bookIcon');
  bookIcon.classList.add('active');
  showToast('Book icon activated! Click it to play Tic Tac Toe.');
}

function openTicTacToeEasterEgg() {
  const modal = document.getElementById('tictactoeEasterEgg');
  modal.classList.add('active');
}

function closeTicTacToeEasterEgg() {
  const modal = document.getElementById('tictactoeEasterEgg');
  modal.classList.remove('active');
}

function initializeTicTacToe() {
  const grid = document.getElementById('tictactoeGrid');
  grid.innerHTML = '';
  
  // Create 3x3 grid
  for (let i = 0; i < 9; i++) {
    const cell = document.createElement('div');
    cell.className = 'tictactoe-cell';
    cell.dataset.index = i;
    cell.addEventListener('click', () => handleTicTacToeClick(i));
    grid.appendChild(cell);
  }
  
  startNewTicTacToeGame();
}

function startNewTicTacToeGame() {
  tictactoeGameState = {
    board: ['', '', '', '', '', '', '', '', ''],
    currentPlayer: 'X',
    gameOver: false
  };
  
  updateTicTacToeDisplay();
}

function handleTicTacToeClick(index) {
  if (tictactoeGameState.gameOver || tictactoeGameState.board[index] !== '') {
    return;
  }
  
  // Make move
  tictactoeGameState.board[index] = tictactoeGameState.currentPlayer;
  
  // Check for win or draw
  if (checkTicTacToeWin()) {
    tictactoeGameState.gameOver = true;
    document.getElementById('tictactoeStatus').textContent = `Player ${tictactoeGameState.currentPlayer} wins!`;
  } else if (tictactoeGameState.board.every(cell => cell !== '')) {
    tictactoeGameState.gameOver = true;
    document.getElementById('tictactoeStatus').textContent = "It's a draw!";
  } else {
    // Switch player
    tictactoeGameState.currentPlayer = tictactoeGameState.currentPlayer === 'X' ? 'O' : 'X';
    document.getElementById('tictactoeStatus').textContent = `Player ${tictactoeGameState.currentPlayer}'s turn`;
  }
  
  updateTicTacToeDisplay();
}

function checkTicTacToeWin() {
  const winPatterns = [
    [0, 1, 2], [3, 4, 5], [6, 7, 8], // rows
    [0, 3, 6], [1, 4, 7], [2, 5, 8], // columns
    [0, 4, 8], [2, 4, 6] // diagonals
  ];
  
  return winPatterns.some(pattern => {
    const [a, b, c] = pattern;
    return tictactoeGameState.board[a] !== '' && 
           tictactoeGameState.board[a] === tictactoeGameState.board[b] && 
           tictactoeGameState.board[a] === tictactoeGameState.board[c];
  });
}

function updateTicTacToeDisplay() {
  const cells = document.querySelectorAll('.tictactoe-cell');
  cells.forEach((cell, index) => {
    cell.textContent = tictactoeGameState.board[index];
    cell.className = 'tictactoe-cell';
    if (tictactoeGameState.board[index] === 'X') {
      cell.classList.add('x');
    } else if (tictactoeGameState.board[index] === 'O') {
      cell.classList.add('o');
    }
  });
}

/* ---------- New Easter Egg Functions ---------- */
function openQuotaModal() {
  const modal = document.getElementById('quotaModal');
  modal.classList.add('active');
}

function closeQuotaModal() {
  const modal = document.getElementById('quotaModal');
  modal.classList.remove('active');
}

function showExtendedQuotaInfo() {
  closeQuotaModal();
  const modal = document.getElementById('extendedQuotaModal');
  modal.classList.add('active');
}

function closeExtendedQuotaModal() {
  const modal = document.getElementById('extendedQuotaModal');
  modal.classList.remove('active');
}

function showQuestionMark() {
  const questionMark = document.getElementById('questionMark');
  questionMark.classList.add('active');
  questionMarkShown = true;
}

function hideQuestionMark() {
  const questionMark = document.getElementById('questionMark');
  questionMark.classList.remove('active');
}

function openRickrollModal() {
  questionMarkClickCount++;
  const modal = document.getElementById('rickrollModal');
  modal.classList.add('active');
  
  // Hide question mark after first click
  if (questionMarkClickCount === 1) {
    hideQuestionMark();
  }
}

function closeRickrollModal() {
  const modal = document.getElementById('rickrollModal');
  modal.classList.remove('active');
}

/* ---------- Static data functions ---------- */
function getTrendingPrompts() {
  return STATIC_PROMPTS.filter(p => p.isTrending === true && p.accepted === true);
}

function getGalleryPrompts() {
  allGalleryPrompts = [...STATIC_PROMPTS, ...userPrompts].filter(p => p.accepted === true);
  return allGalleryPrompts;
}

function getMyPrompts() {
  if (!currentUser || !currentUser.username) return [];
  return userPrompts.filter(p => p.username === currentUser.username);
}

function getPendingPrompts() {
  return userPrompts.filter(p => !p.accepted);
}

function getAdminStats() {
  const allPrompts = [...STATIC_PROMPTS, ...userPrompts];
  const totalPrompts = allPrompts.length;
  const acceptedPrompts = allPrompts.filter(p => p.accepted).length;
  const pendingPrompts = allPrompts.filter(p => !p.accepted).length;
  const trendingPrompts = allPrompts.filter(p => p.isTrending).length;
  const totalUsers = STATIC_USERS.length;
  
  return {
    total_prompts: totalPrompts,
    accepted_prompts: acceptedPrompts,
    pending_prompts: pendingPrompts,
    trending_prompts: trendingPrompts,
    total_users: totalUsers
  };
}

function getStats() {
  const allPrompts = [...STATIC_PROMPTS, ...userPrompts];
  const totalPrompts = allPrompts.length;
  const totalUsers = STATIC_USERS.length;
  const trendingPrompts = allPrompts.filter(p => p.isTrending).length;
  const categories = [...new Set(allPrompts.map(p => p.model))].length;
  
  return {
    total_prompts: totalPrompts,
    total_users: totalUsers,
    trending_prompts: trendingPrompts,
    categories: categories
  };
}

/* ---------- Render functions ---------- */
function formatDate(iso){
  try {
    return new Date(iso).toLocaleDateString();
  } catch(e) {
    return iso;
  }
}
function escapeHtml(s){ return (s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

function makeCardElement(prompt){
  const container = document.createElement('div');
  container.className = 'card fade-in';
  container.dataset.id = prompt.id;

  // Add trending badge if applicable
  if (prompt.isTrending) {
    const badge = document.createElement('div');
    badge.className = 'badge';
    badge.textContent = 'Trending';
    badge.style.position = 'absolute';
    badge.style.top = '10px';
    badge.style.right = '10px';
    badge.style.zIndex = '1';
    container.appendChild(badge);
  }

  // Add pending badge for unapproved prompts (admin view)
  if (!prompt.accepted && currentUser.role === 'admin') {
    const badge = document.createElement('div');
    badge.className = 'badge pending';
    badge.textContent = 'Pending';
    badge.style.position = 'absolute';
    badge.style.top = '10px';
    badge.style.left = '10px';
    badge.style.zIndex = '1';
    container.appendChild(badge);
  }

  // image container
  const imgWrap = document.createElement('div');
  imgWrap.className = 'img';
  if(prompt.image_url){
    const img = document.createElement('img');
    img.src = prompt.image_url;
    img.alt = prompt.title || 'prompt image';
    img.onerror = function() {
      this.style.display = 'none';
      imgWrap.textContent = 'Image not available';
      imgWrap.style.display = 'flex';
      imgWrap.style.alignItems = 'center';
      imgWrap.style.justifyContent = 'center';
      imgWrap.style.color = 'var(--muted)';
    };
    imgWrap.appendChild(img);
  } else {
    imgWrap.textContent = 'No image';
    imgWrap.style.display = 'flex';
    imgWrap.style.alignItems = 'center';
    imgWrap.style.justifyContent = 'center';
    imgWrap.style.color = 'var(--muted)';
  }
  container.appendChild(imgWrap);

  // title
  const h = document.createElement('h4');
  h.innerHTML = `<span>${escapeHtml(prompt.title || prompt.text.slice(0,40))}</span>`;
  container.appendChild(h);

  // tagline
  const tag = document.createElement('div');
  tag.className = 'tagline';
  tag.textContent = prompt.tagline || `By ${prompt.username || 'Anonymous'} ‚Ä¢ ${formatDate(prompt.created_at || prompt.created)}`;
  container.appendChild(tag);

  // prompt box
  const pbox = document.createElement('div');
  pbox.className = 'prompt-box';
  pbox.textContent = prompt.text || '';
  container.appendChild(pbox);

  // model info
  const modelInfo = document.createElement('div');
  modelInfo.className = 'model-info';
  modelInfo.innerHTML = `
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <span>Works with: ${prompt.model || 'Multiple AI Models'}</span>
  `;
  container.appendChild(modelInfo);

  // Admin actions
  if (currentUser.role === 'admin' && !prompt.accepted) {
    const adminActions = document.createElement('div');
    adminActions.className = 'admin-actions';

    const approveBtn = document.createElement('button');
    approveBtn.className = 'btn btn-success';
    approveBtn.innerHTML = '‚úì Approve';
    approveBtn.onclick = () => approvePrompt(prompt.id);

    const rejectBtn = document.createElement('button');
    rejectBtn.className = 'btn btn-danger';
    rejectBtn.innerHTML = '‚úó Reject';
    rejectBtn.onclick = () => rejectPrompt(prompt.id);

    adminActions.appendChild(approveBtn);
    adminActions.appendChild(rejectBtn);
    container.appendChild(adminActions);
  }

  // bottom row (copy button) - only for accepted prompts
  if (prompt.accepted) {
    const bottom = document.createElement('div');
    bottom.className = 'card-bottom';

    const copyBtn = document.createElement('button');
    copyBtn.className = 'copy-btn';
    copyBtn.title = 'Copy prompt text';
    copyBtn.innerHTML = `
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M9 12H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v4" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
        <rect x="9" y="9" width="11" height="11" rx="2" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Copy the Prompt
    `;
    bottom.appendChild(copyBtn);

    copyBtn.addEventListener('click', async ()=>{
      try {
        await navigator.clipboard.writeText(prompt.text || '');
        showToast('Prompt copied to clipboard');
        const originalHTML = copyBtn.innerHTML;
        copyBtn.innerHTML = `
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Copied!
        `;
        setTimeout(()=> { copyBtn.innerHTML = originalHTML; }, 2000);
      } catch(e){
        alert('Copy failed ‚Äî your browser blocked clipboard access.');
      }
    });

    container.appendChild(bottom);
  }

  return container;
}

/* ---------- Admin Dashboard Functions ---------- */
async function loadAdminDashboard() {
  if (currentUser.role !== 'admin') return;
  
  await loadAdminStats();
  await loadPendingPrompts();
}

async function loadAdminStats() {
  try {
    const stats = getAdminStats();
    document.getElementById('adminTotalPrompts').textContent = stats.total_prompts;
    document.getElementById('adminApprovedPrompts').textContent = stats.accepted_prompts;
    document.getElementById('adminPendingPrompts').textContent = stats.pending_prompts;
    document.getElementById('adminTrendingPrompts').textContent = stats.trending_prompts;
    document.getElementById('adminTotalUsers').textContent = stats.total_users;
  } catch (e) {
    console.error('Error loading admin stats:', e);
  }
}

async function loadPendingPrompts() {
  const container = document.getElementById('pendingPromptsList');
  container.innerHTML = '<div class="muted">Loading pending prompts...</div>';
  
  try {
    const prompts = getPendingPrompts();
    if (!prompts || prompts.length === 0) {
      container.innerHTML = '<div class="muted">No pending prompts for review.</div>';
      return;
    }

    container.innerHTML = `
      <div style="margin-bottom: 12px; font-size: 14px; color: var(--muted)">
        ${prompts.length} prompt(s) awaiting approval
      </div>
    `;

    prompts.forEach(prompt => {
      const item = document.createElement('div');
      item.className = 'checkbox-item';
      item.innerHTML = `
        <input type="checkbox" id="check-${prompt.id}" onchange="togglePromptSelection('${prompt.id}')">
        <div style="flex: 1;">
          <div style="font-weight: 600;">${escapeHtml(prompt.title)}</div>
          <div style="font-size: 12px; color: var(--muted); margin-top: 4px;">
            By ${prompt.username} ‚Ä¢ ${formatDate(prompt.created_at || prompt.created)} ‚Ä¢ ${prompt.model}
          </div>
          <div style="font-size: 13px; margin-top: 8px; color: #555;">
            ${escapeHtml(prompt.text.length > 150 ? prompt.text.substring(0, 150) + '...' : prompt.text)}
          </div>
        </div>
        <div class="admin-actions">
          <button class="btn btn-success" onclick="approvePrompt('${prompt.id}')">‚úì Approve</button>
          <button class="btn btn-danger" onclick="rejectPrompt('${prompt.id}')">‚úó Reject</button>
        </div>
      `;
      container.appendChild(item);
    });

  } catch (e) {
    console.error('Error loading pending prompts:', e);
    container.innerHTML = '<div class="muted">Error loading pending prompts.</div>';
  }
}

function togglePromptSelection(promptId) {
  const checkbox = document.getElementById(`check-${promptId}`);
  if (checkbox.checked) {
    selectedPrompts.add(promptId);
  } else {
    selectedPrompts.delete(promptId);
  }
  updateBulkActions();
}

function updateBulkActions() {
  const bulkActions = document.getElementById('bulkActions');
  const selectedCount = document.getElementById('selectedCount');
  
  if (selectedPrompts.size > 0) {
    bulkActions.style.display = 'flex';
    selectedCount.textContent = `${selectedPrompts.size} selected`;
  } else {
    bulkActions.style.display = 'none';
  }
}

function clearSelection() {
  selectedPrompts.clear();
  document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
    checkbox.checked = false;
  });
  updateBulkActions();
}

function bulkApprovePrompts() {
  if (selectedPrompts.size === 0) return;
  
  selectedPrompts.forEach(promptId => {
    approvePrompt(promptId);
  });
  
  showToast(`Approved ${selectedPrompts.size} prompts!`);
  selectedPrompts.clear();
  updateBulkActions();
  loadAdminDashboard();
  loadGallery();
  loadTrending();
}

function bulkRejectPrompts() {
  if (selectedPrompts.size === 0) return;
  
  if (!confirm(`Are you sure you want to reject ${selectedPrompts.size} prompt(s)?`)) return;
  
  selectedPrompts.forEach(promptId => {
    rejectPrompt(promptId);
  });
  
  showToast(`Rejected ${selectedPrompts.size} prompts!`);
  selectedPrompts.clear();
  updateBulkActions();
  loadAdminDashboard();
  loadGallery();
  loadTrending();
}

/* ---------- Admin functions ---------- */
function approvePrompt(promptId) {
  const promptIndex = userPrompts.findIndex(p => p.id === promptId);
  if (promptIndex !== -1) {
    userPrompts[promptIndex].accepted = true;
    localStorage.setItem('userPrompts', JSON.stringify(userPrompts));
    showToast('Prompt approved!');
    loadAdminDashboard();
    loadGallery();
    loadTrending();
  }
}

function rejectPrompt(promptId) {
  if (!confirm('Are you sure you want to reject this prompt?')) return;
  
  userPrompts = userPrompts.filter(p => p.id !== promptId);
  localStorage.setItem('userPrompts', JSON.stringify(userPrompts));
  showToast('Prompt rejected and deleted');
  loadAdminDashboard();
  loadGallery();
  loadTrending();
}

/* ---------- Load Trending ---------- */
async function loadTrending(){
  const grid = document.getElementById('trendingGrid');
  grid.innerHTML = '<div class="muted">Loading‚Ä¶</div>';
  const prompts = getTrendingPrompts();
  grid.innerHTML = '';
  
  if (prompts.length === 0) {
    grid.innerHTML = '<div class="muted">No trending prompts found.</div>';
    return;
  }
  
  prompts.forEach(p=>{
    grid.appendChild(makeCardElement(p));
  });
  updateStats();

  setTimeout(() => {
    const cards = grid.querySelectorAll('.fade-in');
    cards.forEach(card => { card.classList.add('visible'); });
  }, 80);
}

/* ---------- Load Gallery ---------- */
async function loadGallery(){
  const grid = document.getElementById('galleryGrid');
  grid.innerHTML = '<div class="muted">Loading‚Ä¶</div>';
  
  const prompts = getGalleryPrompts();
  
  grid.innerHTML = '';
  
  if (prompts.length === 0) {
    grid.innerHTML = '<div class="muted">No prompts found. Submit some prompts!</div>';
    return;
  }
  
  prompts.forEach(p => {
    const el = makeCardElement(p);
    grid.appendChild(el);
  });
  
  // Make cards visible immediately instead of with delay
  const cards = grid.querySelectorAll('.fade-in');
  cards.forEach(c => c.classList.add('visible'));
  
  updateStats();
}

/* ---------- My prompts ---------- */
async function loadMyPrompts(){
  const list = document.getElementById('myPromptsList');
  const prompts = getMyPrompts();
  
  if(!currentUser || !currentUser.username) { 
    list.innerHTML = '<div class="muted">Login to see your prompts here.</div>'; 
    return; 
  }
  
  if(prompts.length === 0) {
    list.innerHTML = '<div class="muted">You have no prompts yet. Submit your first prompt above!</div>';
  } else {
    list.innerHTML = prompts.map(p=> `
      <div style="margin-bottom:10px;padding:12px;border-radius:10px;background:#${p.accepted ? 'f0f9ff' : 'fff7ed'}; border-left: 4px solid ${p.accepted ? '#3b82f6' : '#f59e0b'}">
        <div style="font-weight:600">${escapeHtml(p.title || p.text.slice(0,140))}</div>
        <div class="muted" style="font-size:12px; margin-top:4px">
          ${formatDate(p.created_at || p.created)} ‚Ä¢ 
          <strong style="color:${p.accepted ? '#10b981' : '#f59e0b'}">
            ${p.accepted ? 'Approved' : 'Pending Approval'}
          </strong>
        </div>
      </div>
    `).join('');
  }
}

/* ---------- Update stats ---------- */
async function updateStats(){
  try {
    const stats = getStats();
    document.getElementById('statPrompts').textContent = stats.total_prompts;
    document.getElementById('statUsers').textContent = stats.total_users;
    document.getElementById('statCats').textContent = stats.categories;
  } catch (e) {
    console.error('Error updating stats:', e);
    document.getElementById('statPrompts').textContent = '0';
    document.getElementById('statUsers').textContent = '0';
    document.getElementById('statCats').textContent = '0';
  }
}

/* ---------- Submission handlers ---------- */
document.getElementById('fimage').addEventListener('input', (e)=>{
  const url = e.target.value;
  const preview = document.getElementById('fpreview');
  preview.innerHTML = '';
  if(!url) return;
  
  const img = document.createElement('img'); 
  img.src = url; 
  img.style.maxWidth='100%'; 
  img.style.borderRadius='8px';
  img.style.maxHeight = '200px';
  img.onerror = function() {
    preview.innerHTML = '<div style="color: var(--danger); font-size: 12px;">Invalid image URL</div>';
  };
  preview.appendChild(img);
});

// ‚úÖ FIXED: Complete submission handling with authentication check
document.getElementById('submitBtn').addEventListener('click', async ()=>{
  const username = document.getElementById('fusername').value.trim();
  const title = document.getElementById('ftitle').value.trim();
  const tagline = document.getElementById('ftagline').value.trim();
  const model = document.getElementById('fmodel').value;
  const text = document.getElementById('ftext').value.trim();
  const image_url = document.getElementById('fimage').value.trim();
  
  if(!username || !title || !tagline || !model || !text) {
    return alert('Please fill all required fields: Username, Title, Tagline, Model, and Prompt Text');
  }

  // ‚úÖ FIXED: Check if user is logged in
  if (!currentUser || !currentUser.username) {
    // Show quota modal for non-logged in users
    openQuotaModal();
    return;
  }

  // Use uploaded image URL if available, otherwise use the URL input
  const finalImageUrl = uploadedImageUrl || image_url || null;

  const promptData = {
    id: 'user_' + Date.now(),
    username: currentUser.username, // Always use logged in username
    title,
    tagline,
    model,
    text,
    image_url: finalImageUrl,
    accepted: currentUser.role === 'admin', // Auto-approve if admin
    isTrending: false,
    created_at: new Date().toISOString()
  };

  // Add to user prompts
  userPrompts.push(promptData);
  localStorage.setItem('userPrompts', JSON.stringify(userPrompts));
  
  showToast('Prompt submitted successfully!' + (currentUser.role === 'admin' ? '' : ' Waiting for admin approval.'));
  
  // Clear form but keep username if user is logged in
  document.getElementById('ftitle').value = '';
  document.getElementById('ftagline').value = '';
  document.getElementById('fmodel').value = '';
  document.getElementById('ftext').value = '';
  document.getElementById('fimage').value = '';
  document.getElementById('fpreview').innerHTML = '';
  
  // Reset file upload
  const uploadPreview = document.getElementById('uploadPreview');
  const uploadProgress = document.getElementById('uploadProgress');
  const fileInput = document.getElementById('fileInput');
  uploadPreview.innerHTML = '';
  uploadProgress.style.display = 'none';
  fileInput.value = '';
  uploadedImageUrl = null;
  
  loadGallery();
  loadTrending();
  loadMyPrompts();
});

document.getElementById('clearBtn').addEventListener('click', ()=>{
  // Don't clear username if user is logged in
  document.getElementById('ftitle').value = '';
  document.getElementById('ftagline').value = '';
  document.getElementById('fmodel').value = '';
  document.getElementById('ftext').value = '';
  document.getElementById('fimage').value = '';
  document.getElementById('fpreview').innerHTML = '';
  
  // Reset file upload
  const uploadPreview = document.getElementById('uploadPreview');
  const uploadProgress = document.getElementById('uploadProgress');
  const fileInput = document.getElementById('fileInput');
  uploadPreview.innerHTML = '';
  uploadProgress.style.display = 'none';
  fileInput.value = '';
  uploadedImageUrl = null;
});

/* ---------- Toast ---------- */
let toastTimer = null;
function showToast(msg){
  const toast = document.getElementById('toast');
  const ttext = document.getElementById('toastText');
  ttext.textContent = msg || 'Copied to clipboard';
  toast.classList.add('show');
  toast.style.display = 'flex';
  if(toastTimer) clearTimeout(toastTimer);
  toastTimer = setTimeout(()=>{
    toast.classList.remove('show');
    setTimeout(()=>{ toast.style.display = 'none'; }, 280);
  }, 3000);
}

/* ---------- Auto-fill username if logged in ---------- */
function updateSubmitForm() {
  if (currentUser && currentUser.username) {
    document.getElementById('fusername').value = currentUser.username;
    document.getElementById('fusername').readOnly = true;
    document.getElementById('fusername').style.background = '#f8f9fa';
  } else {
    document.getElementById('fusername').readOnly = false;
    document.getElementById('fusername').style.background = 'transparent';
  }
}

/* ---------- init ---------- */
(function init(){
  updateSubmitForm();
  loadTrending();
  navTo('home');
})();
  </script>
</body>
</html>
